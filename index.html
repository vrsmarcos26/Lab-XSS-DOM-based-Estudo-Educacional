<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laboratório de XSS Baseado em DOM</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="lab-container">
        <header>
            <h1>
                Laboratório de XSS
            </h1>
            <p>Ambiente de estudo de vulnerabilidades DOM-based XSS.</p>
        </header>

        <main>
            <form id="formulario" action="" method="get">
                <label for="pesquisa">Digite sua busca para testar o DOM:</label>
                <div class="input-group">
                    <input type="text" id="pesquisa" name="pesquisa" placeholder="<img src=x onerror=alert(1)>">
                    <input type="submit" value="Pesquisar">
                </div>
            </form>
            
            <div class="results">
                <p id="resultado">Aguardando sua pesquisa...</p>
                <p id="flag"></p>
            </div>
        </main>
    </div>

    <script>
        document.getElementById("formulario").onsubmit = function(event) {
            event.preventDefault();
            var pesquisa = document.getElementById("pesquisa").value;
            var resultadoEl = document.getElementById("resultado");
            var flagEl = document.getElementById("flag");

            // Usar textContent para o texto seguro previne XSS dentro da própria mensagem
            resultadoEl.textContent = "Você pesquisou por: ";
            // E innerHTML apenas para o conteúdo que *deve* ser vulnerável
            var spanVulneravel = document.createElement('span');
            spanVulneravel.innerHTML = pesquisa;
            resultadoEl.appendChild(spanVulneravel);


            // Detecção básica de tentativa de XSS para revelar a flag
            if (pesquisa.toLowerCase().includes("<script>") || 
                pesquisa.toLowerCase().includes("onerror") || 
                pesquisa.toLowerCase().includes("alert(")) {
                flagEl.innerHTML = "Flag encontrada: <strong>FLAG{X55_J4V45CR1PT_5UC3550}</strong>";
            } else {
                flagEl.innerHTML = "";
            }
        };
    </script>
</body>
</html>
